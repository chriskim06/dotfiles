#!/usr/bin/env bash

set -euo pipefail

#
# install everything
#

# get Homebrew
if ! command -v brew &> /dev/null; then
  if [[ "$(uname)" == 'Linux' ]]; then
    sh -c "$(curl -fsSL https://raw.githubusercontent.com/Linuxbrew/install/master/install.sh)"
    /home/linuxbrew/.linuxbrew/bin/brew bundle install
    /home/linuxbrew/.linuxbrew/bin/brew/opt/fzf/install
  else
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    brew bundle install
  fi
fi

# symlink stuff
CWD=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)

mkdir -p "$HOME/.vim/after/ftplugin" "$HOME/.vim/autoload" "$HOME/.vim/config" "$HOME/.config/alacritty" "$HOME/.config/spotify-tui" "$HOME/bin/completion"
for f in $(git ls-files -- ':!:README.md' ':!:Brewfile' ':!:install'); do
  ln -sf "$CWD/$f" "$HOME/$f"
done

# install tpm
[[ ! -d ~/.tmux/plugins/tpm ]] && git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm

# make directory for personal repos
mkdir -p "$HOME/src/chriskim06"

# create empty file for secrets/tokens and local aliases
touch "$HOME/.private"
